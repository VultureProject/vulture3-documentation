<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>WAF Ruleset</title>

    <link rel="stylesheet" href="https://www.vultureproject.org/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://www.vultureproject.org/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://www.vultureproject.org/css/highlight.dark.css">
    <link rel="stylesheet" href="https://www.vultureproject.org/css/main.css">
</head>
<body class="">

<header class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <a href="https://www.vultureproject.org/" class="navbar-brand"><img src="https://www.vultureproject.org/doc/img/logo.png" alt=""></a>
            <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <div>
            <ul class="nav navbar-nav navbar-right">
                <h1>Vulture 3.0 Documentation</h1>

            </ul>
        </div>
    </div>
</header>


<main class="container-fluid">
    <div class="row">

        
            <nav id="sidebar" class="col-sm-3 col-lg-2" role="navigation">

                <ul class="nav nav-pills nav-stacked">
                                            <li class="">
                            <a href="https://www.vultureproject.org/">
                                <i class='fa fa-home'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Vulture
                            </a>
                        </li>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/getting-started.html">
                                <i class='fa fa-star'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Getting Started
                            </a>
                        </li>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/install/steps.html">
                                <i class='fa fa-download'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Installation
                            </a>
                        </li>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/reporting/map.html">
                                <i class='fa fa-bar-chart'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Reporting
                            </a>
                        </li>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/management/nodes.html">
                                <i class='fa fa-desktop'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Management
                            </a>
                        </li>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/repositories/repo.html">
                                <i class='fa fa-database'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Repositories
                            </a>
                        </li>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/network/network.html">
                                <i class='fa fa-globe'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Network
                            </a>
                        </li>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/configuration/profile.html">
                                <i class='fa fa-gear'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Configuration
                            </a>
                        </li>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/waf/waf.html">
                                <i class='fa fa-cloud'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Web firewall
                            </a>
                        </li>
                                                <ul class="submenu nav nav-stacked nav-pills">
                                                        <li class="active">
                                <a href="https://www.vultureproject.org/doc/waf/ruleset.html">
                                    WAF Ruleset
                                </a>
                            </li>

                                                        <ul class="submenu nav nav-stacked nav-pills">
                                                            </ul>
                            
                                                        <li class="">
                                <a href="https://www.vultureproject.org/doc/waf/policy.html">
                                    WAF Policy
                                </a>
                            </li>

                            
                                                        <li class="">
                                <a href="https://www.vultureproject.org/doc/waf/virtualpatching.html">
                                    Virtual Patching
                                </a>
                            </li>

                            
                                                        <li class="">
                                <a href="https://www.vultureproject.org/doc/waf/dataset.html">
                                    Datasets
                                </a>
                            </li>

                            
                                                        <li class="">
                                <a href="https://www.vultureproject.org/doc/waf/pf.html">
                                    Packet Filter
                                </a>
                            </li>

                            
                                                    </ul>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/app/app.html">
                                <i class='fa fa-cubes'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Applications
                            </a>
                        </li>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/app/template.html">
                                <i class='fa fa-file-code-o'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Portal Templates
                            </a>
                        </li>
                                                                    <li class="">
                            <a href="https://www.vultureproject.org/doc/troubleshooting/troubleshooting.html">
                                <i class='fa fa-wrench'>&nbsp;&nbsp;&nbsp;&nbsp;</i>Troubleshooting
                            </a>
                        </li>
                                                            </ul>
            </nav>

        
        <section id="content" class="col-sm-offset-3 col-lg-offset-2 col-sm-9 col-lg-10">
            <h1>WAF Ruleset</h1>
            <p>Vulture gives you the possibility to edit security rules based on modules <a href="https://www.modsecurity.org/">mod_security</a> and <a href="https://github.com/VultureProject/mod_defender">mod_defender</a>.
When you create whitelist / blacklist from <a href="../management/logs.html">logs</a>, related rules appear here.</p>
<p><strong>There is multiple Apache mod_security rules sources</strong></p>
<ul>
<li><code>Manually edit the rules</code>: Writing custom mod_security rules.</li>
<li><code>Import OWASP rules</code>: Download mod_security rules package defined by owasp covering a large panel of known vulnerabilities.<br/>
The repository link is customizable from <a href="../management/services.html">Management service ModSecurity URL</a>.</li>
</ul>
<p>It's possible to fine select those imported OWASP rules. Clicking on the &quot;OWASP_CRS&quot; rule dataset gives you the ability to toggle specific rules. It is also possible to edit those rules.</p>
<p>Vulture gives you the ability to use <a href="../waf/virtualpatching.html">Virtual Patching</a>, which generates a list of mod_security rules from a vulnerability scan report.</p>
<p>There is also some whitelist rulesets for known CMS provided out of the box by Vulture, their names end with 'WL' and are used by mod_defender.</p>
<h1 id="vulturers">VultureRS</h1>
<h2 id="anti-session-hijacking">Anti Session Hijacking</h2>
<p><img src="/doc/img/session_hijacking.png" alt="SessionHijacking" /></p>
<h2 id="csrf-token">CSRF Token</h2>
<p>Inject a CSRF token in every form, which will be checked upon each POST request.
If the CSRF does not match with the one generated by Vulture, the anomaly score is increased by the specified amount in the WAF Policy.</p>
<h2 id="user-agent-checking">User-Agent checking</h2>
<p>Capture the User-Agent and check whether it is an:</p>
<ul>
<li>Unknown UA</li>
<li>UA Anonymous</li>
<li>UA Bot</li>
<li>UA Browser</li>
<li>UA Cloud</li>
<li>UA Console</li>
<li>UA Crawler</li>
<li>UA Emailclient</li>
<li>UA Emailharvester</li>
<li>UA Mobile</li>
<li>UA Script</li>
</ul>
<h2 id="content-type-whitelist">Content-type whitelist</h2>
<p>Check whether the Content-Type is one of the following (specified in the WAF Policy):</p>
<ul>
<li>application/x-www-form-urlencoded</li>
<li>multipart/form-data</li>
<li>text/xml</li>
<li>application/xml</li>
<li>application/x-amf</li>
<li>application/json</li>
<li>application/json-rpc</li>
</ul>
<h2 id="protocol-whitelist">Protocol whitelist</h2>
<p>Check whether the Content-Type is one of the following (specified in the WAF Policy):</p>
<ul>
<li>HTTP/1.0</li>
<li>HTTP/1.1</li>
<li>HTTP/2</li>
</ul>
<h2 id="file-extension-whitelist">File extension whitelist</h2>
<p>For a file upload, check whether the file extension is included in the list specified in the WAF Policy</p>
<h2 id="headers-whitelist">Headers whitelist</h2>
<p>Check whether sent Header field is not one of the following (specified in the WAF Policy):</p>
<ul>
<li>Proxy-Connection</li>
<li>Lock-Token</li>
<li>Content-Range</li>
<li>Translate</li>
<li>via</li>
<li>if</li>
</ul>
        </section>

    </div>
</main>



<script src="https://www.vultureproject.org/js/jquery-1.11.0.min.js"></script>
<script src="https://www.vultureproject.org/js/bootstrap.min.js"></script>
<script src="https://www.vultureproject.org/js/highlight.min.js"></script>

<script>
    $(function() {
        $("section>h1").wrap('<div class="page-header" />');
        // Syntax highlighting
        hljs.initHighlightingOnLoad();
    });
</script>


</body>
</html>

